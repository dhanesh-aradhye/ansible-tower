---
  - name: Test ansible Tower ec2 create
    hosts: local
    connection: local

    tasks:
      auth:
        aws_access_key: "{{ AWS_ACCESS_KEY_ID }}"
        aws_secret_key: "{{ AWS_SECRET_ACCESS_KEY }}"
        aws_ec2_region: "{{ REGION }}"
      - name: Creating the ec2 instance using vars
        ec2:
          key_name: KEY_NAME
          instance_type: t2.micro
          image: EC2_IMAGE
          region: "{{ REGION }}"
          wait: yes
          count: 1
          vpc_subnet_id: "{{ VPC_SUBNET_ID }}"
          assign_public_ip: no
          instance_tags:
            Name: via-ansible-tower
